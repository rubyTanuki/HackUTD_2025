<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Thesis Upload</title>

  <!-- Tailwind + Flowbite + Bootstrap Icons -->
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://unpkg.com/flowbite@1.6.5/dist/flowbite.min.js"></script>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css">

  <style>
    body {
      padding: 40px;
      background: #0f172a; /* dark blue gray */
    }
  </style>
</head>
<body class="dark:bg-gray-900 text-white">

  <div class="max-w-3xl mx-auto">
    <h2 class="text-3xl font-semibold text-white mb-8 text-center">Upload or Type Your Thesis</h2>

    <!-- Text Editor Card -->
    <form onsubmit="event.preventDefault(); uploadData();">
      <div class="w-full mb-6 border border-gray-700 rounded-lg bg-gray-800 shadow-md">
        <div class="flex items-center justify-between px-3 py-2 border-b border-gray-700 bg-gray-900 rounded-t-lg">
          <div class="flex items-center space-x-2">
            <!-- üìé Paperclip for file upload -->
            <label for="fileInput" class="p-2 text-gray-400 hover:text-white hover:bg-gray-700 rounded-sm cursor-pointer">
              <i class="bi bi-paperclip text-lg"></i>
              <span class="sr-only">Attach File</span>
              <input id="fileInput" type="file" class="hidden" accept=".pdf" />
            </label>
          </div>

          <button type="button"
            class="p-2 text-gray-400 hover:text-white hover:bg-gray-700 rounded-sm">
            <span class="text-xs">Full Screen</span>
          </button>
        </div>

        <!-- ‚úèÔ∏è Thesis Text Area -->
        <div class="px-4 py-3 bg-gray-800 rounded-b-lg">
          <textarea id="dataInput" rows="8"
            class="block w-full px-0 text-base text-white bg-gray-800 border-0 focus:ring-0 placeholder-gray-400"
            placeholder="Write your thesis here..." required></textarea>
        </div>
      </div>

      <!-- File status below editor -->
      <p id="fileStatus" class="text-center text-gray-400 mb-6">No file selected.</p>

      <!--  Upload Button -->
      <div class="text-center">
        <button type="submit"
          class="px-8 py-3 text-base font-medium text-white bg-blue-600 hover:bg-blue-700 rounded-lg focus:ring-4 focus:ring-blue-400 transition">
          Upload
        </button>
      </div>
    </form>

    <!--  Debug/Output -->
    <pre id="output" class="mt-8 p-4 bg-gray-900 text-gray-300 rounded-lg overflow-x-auto text-sm whitespace-pre-wrap"></pre>
  </div>

  <script>
    //  Update file status when file selected via paperclip
    document.getElementById("fileInput").addEventListener("change", () => {
      const file = document.getElementById("fileInput").files[0];
      const fileStatus = document.getElementById("fileStatus");

      if (file) {
        const sizeMB = (file.size / (1024 * 1024)).toFixed(2);
        fileStatus.textContent = `File attached: ${file.name} (${sizeMB} MB)`;
        fileStatus.classList.add("text-green-400");
      } else {
        fileStatus.textContent = "No file selected.";
        fileStatus.classList.remove("text-green-400");
      }
    });

    //  Upload Function (Mock Backend)
    async function uploadData() {
      const textarea = document.getElementById("dataInput");
      const textData = textarea.value.trim();
      const output = document.getElementById("output");

      if (!textData) {
        alert("Please enter your thesis before uploading!");
        return;
      }

      output.textContent = "Uploading...";

      //  Mock Backend Response
      const mockResponse = {
        response_code: "200",
        quote: "‚ÄúArtificial Intelligence is not a threat, but a tool ‚Äî its impact depends on the hands that use it.‚Äù",
        results: [
          {
            title: "AI and the Future of Learning",
            description: "Examines how AI tools adapt to student learning styles.",
            keywords: ["AI", "Education", "Adaptive Learning"],
            why_chosen: "Matches your thesis focus on personalization.",
            link: "#"
          },
          {
            title: "Ethics in Machine Learning Systems",
            description: "Explores fairness and ethical dilemmas in AI.",
            keywords: ["Ethics", "Bias", "Machine Learning"],
            why_chosen: "Relates to your concern about bias and responsibility.",
            link: "#"
          },
          {
            title: "The Role of Automation in Modern Classrooms",
            description: "Studies how automation transforms teaching approaches.",
            keywords: ["Automation", "Teaching", "Innovation"],
            why_chosen: "Shows real-world applications of your thesis ideas.",
            link: "#"
          }
        ]
      };

      // Store data in localStorage
      localStorage.setItem("uploadedThesis", textData);
      localStorage.setItem("backendResponse", JSON.stringify(mockResponse));

      // Redirect to results
      window.location.href = "results.html";
    }
    
  </script>
</body>
</html>
